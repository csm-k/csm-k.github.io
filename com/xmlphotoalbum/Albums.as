package com.xmlphotoalbum{	import flash.display.Sprite;	import flash.display.Shape;	import flash.display.LineScaleMode;	import flash.display.CapsStyle;	import flash.display.JointStyle;	import flash.events.MouseEvent;	import flash.events.Event;	import flash.text.*;	import caurina.transitions.*;	import flash.geom.Rectangle;	public class Albums extends Sprite {		private var backgroundRect:Shape;		private var backgroundTransparency:Number = 0.4;		private var strokeColor:uint = 0x000000;		private var backgroundStrokeSize:uint = 0x000000;		private var backgroundColor:uint = 0x009999;				private var scrollerWidth:Number = 12;		private var backgroundWidth:Number;		private var backgroundHeight:Number;		private var albumBackgroundWidth:Number;		private var albumBackgroundHeight:Number;		private var noofAlbumsHorizontal:Number = 5;		private var noofAlbumsVertical:Number = 6;		private var albumBox:Sprite;		private var albumBoxHolder:Sprite = new Sprite;		private var SlideXML:XML;		public 	var xmlID:Number;		private var format:TextFormat  = new TextFormat();		private var textMargin:Number = 2;		private var stringLength:Number;		private var fontSize:Number = 9;		private var thumbColor:uint;		function Albums(_SlideXML:XML,_backgroundWidth:Number,_backgroundHeight:Number,_noofAlbumsHorizontal:Number,_noofAlbumsVertical:Number,_thumbColor:uint):void {			format.font =  "Tahoma";			format.color = 0xFFFFFF;			format.size = fontSize;			SlideXML = _SlideXML;			backgroundWidth = _backgroundWidth;			backgroundHeight = _backgroundHeight;			noofAlbumsHorizontal = _noofAlbumsHorizontal;			noofAlbumsVertical = _noofAlbumsVertical;			thumbColor = _thumbColor;			albumBackgroundWidth = (backgroundWidth-scrollerWidth) / noofAlbumsHorizontal;			albumBackgroundHeight = backgroundHeight / noofAlbumsVertical;			var thumbWidth:Number = albumBackgroundWidth / 1;			var thumbHeight:Number = albumBackgroundHeight / 1;			this.drawBackground();			this.addChild(albumBoxHolder);									var folderName:String;									for (var i = 0; i < SlideXML.album.length(); i++) {				folderName = SlideXML.album[i].attribute("folder");				albumBox = new Sprite();				var textSprite:Sprite = new Sprite();				this.albumBackground();				//trace(folderName);				var thumb:Thumbnail = new Thumbnail(folderName,SlideXML.album[i].media[0],thumbWidth,thumbHeight,i,false,thumbColor);				albumBox.addChild(thumb);				thumb.name = i;				var ThumbnailText:TextField= new TextField();				ThumbnailText.x = textMargin;				ThumbnailText.y = textMargin;				ThumbnailText.wordWrap = true;				ThumbnailText.background = true;				ThumbnailText.backgroundColor = 0x000000;				ThumbnailText.width = thumbWidth-textMargin;								ThumbnailText.height = thumbHeight-2*textMargin;				ThumbnailText.autoSize = TextFieldAutoSize.LEFT;				ThumbnailText.defaultTextFormat = format;				stringLength = (thumbWidth*thumbHeight)/(fontSize*fontSize);				var titleString:String = (SlideXML.album[i].attribute("title")).substr(0,stringLength);				ThumbnailText.text = titleString;								ThumbnailText.selectable = false;				textSprite.mouseChildren = false;				albumBoxHolder.addChild(albumBox);				albumBox.x = (i%noofAlbumsHorizontal) * albumBackgroundWidth;				albumBox.y = Math.floor(i/noofAlbumsHorizontal) * albumBackgroundHeight;				thumb.addEventListener(MouseEvent.CLICK,callAlbum);				albumBox.addChild(textSprite);				textSprite.addChild(ThumbnailText);			}						var albumSlider:SliderR = new SliderR(backgroundWidth, backgroundHeight, albumBoxHolder, thumbColor);			addChild(albumSlider);								}		private function albumBackground():void {			backgroundRect = new Shape();			backgroundRect.graphics.beginFill(thumbColor,backgroundTransparency);			backgroundRect.graphics.lineStyle(backgroundStrokeSize, strokeColor, 1, false, LineScaleMode.VERTICAL,CapsStyle.NONE, JointStyle.MITER, 10);			backgroundRect.graphics.drawRect(0, 0, albumBackgroundWidth, albumBackgroundHeight);			backgroundRect.graphics.endFill();			albumBox.addChild(backgroundRect);					}					private function drawBackground():void {			var backRect = new Shape();			backRect.graphics.beginFill(thumbColor, 0.3);			backRect.graphics.drawRect(0, 0, backgroundWidth, backgroundHeight);			backRect.graphics.endFill();			this.addChild(backRect);				}		private function callAlbum(event:MouseEvent):void {			xmlID = event.target.name;			this.dispatchEvent(new Event("showAlbum"));		}	}}